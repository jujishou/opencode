<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="OpenCode自定义命令创建指南，扩展AI能力。">
  <meta name="keywords" content="OpenCode自定义命令, 命令扩展, 自定义功能">
  <meta name="robots" content="index, follow">
  <title>6.3 自定义命令 - OpenCode深度教程</title>
  <link rel="stylesheet" href="../css/style.css">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://opencode.aialiang.com/tutorial/6.3-custom-commands.html">

  <!-- Open Graph Meta Tags -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://opencode.aialiang.com/tutorial/6.3-custom-commands.html">
  <meta property="og:title" content="自定义命令 - OpenCode深度教程">
  <meta property="og:description" content="OpenCode自定义命令创建指南，扩展AI能力。">
  <meta property="og:image" content="https://opencode.aialiang.com/images/og-image.png">
  <meta property="og:site_name" content="OpenCode深度教程">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:section" content="第六章：扩展功能">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="自定义命令 - OpenCode深度教程">
  <meta name="twitter:description" content="OpenCode自定义命令创建指南，扩展AI能力。">
  <meta name="twitter:image" content="https://opencode.aialiang.com/images/og-image.png">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "自定义命令",
    "description": "OpenCode自定义命令创建指南，扩展AI能力。",
    "url": "https://opencode.aialiang.com/tutorial/6.3-custom-commands.html",
    "inLanguage": "zh-CN",
    "isPartOf": {
      "@type": "WebSite",
      "name": "OpenCode深度教程",
      "url": "https://opencode.aialiang.com/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "OpenCode深度教程",
      "url": "https://opencode.aialiang.com/"
    },
    "articleSection": "第六章：扩展功能"
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "首页", "item": "https://opencode.aialiang.com/"},
      {"@type": "ListItem", "position": 2, "name": "第六章：扩展功能", "item": "https://opencode.aialiang.com/tutorial/6.3.1-lsp.html"},
      {"@type": "ListItem", "position": 3, "name": "自定义命令", "item": "https://opencode.aialiang.com/tutorial/6.3-custom-commands.html"}
    ]
  }
  </script>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
</head>
<body>
  <nav class="navbar"><button class="mobile-menu-btn" aria-label="菜单"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button><a href="../index.html" class="navbar-brand"><div class="logo">OC</div><span>OpenCode深度教程</span></a><div class="navbar-nav"><a href="../index.html">首页</a><a href="1.1-what-is-opencode.html">教程</a><a href="../community.html">社群</a><a href="https://opencode.ai/docs" target="_blank">官方文档</a><a href="https://github.com/anomalyco/opencode" target="_blank">GitHub</a></div><div class="navbar-right"><div class="search-box"><svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" class="search-input" placeholder="搜索教程..."><div class="search-results"></div></div><button class="theme-toggle" aria-label="切换主题"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div></nav>
  <aside class="sidebar"><div class="sidebar-content"><div class="sidebar-section"><div class="sidebar-title">第一章：入门指南</div><ul class="sidebar-nav"><li><a href="1.1-what-is-opencode.html"><span class="chapter-number">1.1</span>什么是OpenCode</a></li><li><a href="1.2-installation.html"><span class="chapter-number">1.2</span>安装OpenCode</a></li><li><a href="1.3-quickstart.html"><span class="chapter-number">1.3</span>快速开始</a></li><li><a href="1.4-terminal-requirements.html"><span class="chapter-number">1.4</span>终端要求</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第二章：基础配置</div><ul class="sidebar-nav"><li><a href="2.1-config-file.html"><span class="chapter-number">2.1</span>配置文件详解</a></li><li><a href="2.2-providers.html"><span class="chapter-number">2.2</span>AI提供商配置</a></li><li><a href="2.3-models.html"><span class="chapter-number">2.3</span>模型选择与配置</a></li><li><a href="2.4-environment.html"><span class="chapter-number">2.4</span>环境变量设置</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第三章：界面操作</div><ul class="sidebar-nav"><li><a href="3.1-tui.html"><span class="chapter-number">3.1</span>TUI终端界面</a></li><li><a href="3.2-cli.html"><span class="chapter-number">3.2</span>CLI命令行接口</a></li><li><a href="3.3-web.html"><span class="chapter-number">3.3</span>Web界面</a></li><li><a href="3.4-ide.html"><span class="chapter-number">3.4</span>IDE集成</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第四章：核心功能</div><ul class="sidebar-nav"><li><a href="4.1-tools.html"><span class="chapter-number">4.1</span>内置工具详解</a></li><li><a href="4.2-commands.html"><span class="chapter-number">4.2</span>斜杠命令</a></li><li><a href="4.3-keybinds.html"><span class="chapter-number">4.3</span>快捷键参考</a></li><li><a href="4.4-file-reference.html"><span class="chapter-number">4.4</span>文件引用与搜索</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第五章：高级配置</div><ul class="sidebar-nav"><li><a href="5.1-agents.html"><span class="chapter-number">5.1</span>Agents代理系统</a></li><li><a href="5.2-rules.html"><span class="chapter-number">5.2</span>Rules规则配置</a></li><li><a href="5.3-themes.html"><span class="chapter-number">5.3</span>主题配置</a></li><li><a href="5.4-permissions.html"><span class="chapter-number">5.4</span>权限系统</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第六章：扩展功能</div><ul class="sidebar-nav"><li><a href="6.1-lsp.html"><span class="chapter-number">6.1</span>LSP语言服务器</a></li><li><a href="6.2-formatters.html"><span class="chapter-number">6.2</span>代码格式化器</a></li><li><a href="6.3-custom-commands.html" class="active"><span class="chapter-number">6.3</span>自定义命令</a></li><li><a href="6.4-mcp.html"><span class="chapter-number">6.4</span>MCP协议服务器</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第七章：开发与集成</div><ul class="sidebar-nav"><li><a href="7.1-sdk.html"><span class="chapter-number">7.1</span>SDK使用指南</a></li><li><a href="7.2-network.html"><span class="chapter-number">7.2</span>网络配置</a></li><li><a href="7.3-enterprise.html"><span class="chapter-number">7.3</span>企业版功能</a></li><li><a href="7.4-troubleshooting.html"><span class="chapter-number">7.4</span>故障排除</a></li></ul></div></div></aside>
  <main class="main-content">
    <nav class="breadcrumb"><a href="../index.html">首页</a><span class="breadcrumb-separator">/</span><a href="6.1-lsp.html">第六章</a><span class="breadcrumb-separator">/</span><span>自定义命令</span></nav>
    <article>
      <header class="article-header"><h1 class="article-title">6.3 自定义命令</h1><div class="article-meta"><span class="tag">扩展功能</span><span>第六章：扩展功能</span></div></header>
      <div class="article-content">
        <p>OpenCode支持创建自定义斜杠命令，通过Markdown文件或JSON配置两种方式定义，让你可以快速执行常用的提示模板。</p>

        <h2>Markdown文件方式</h2>
        <p>Markdown方式是创建自定义命令最简单、最直观的方法。</p>

        <h3>文件位置</h3>
        <p>在以下位置创建<code>.opencode/commands/</code>目录：</p>
        <ul>
          <li><strong>项目级</strong>：<code>.opencode/commands/</code>（当前项目目录）</li>
          <li><strong>用户级</strong>：<code>~/.config/opencode/commands/</code>（全局可用）</li>
        </ul>

        <h3>基本格式</h3>
        <p>创建一个<code>.md</code>文件，文件名即为命令名：</p>
        <pre><code># .opencode/commands/review.md

请审查以下代码，检查：

1. 代码质量和可读性
2. 潜在的bug和错误
3. 性能问题
4. 安全漏洞
5. 最佳实践遵循情况

$ARGUMENTS</code></pre>
        <p>使用：<code>/review @src/main.ts</code></p>

        <h3>带Front Matter的格式</h3>
        <p>使用YAML front matter添加元数据：</p>
        <pre><code># .opencode/commands/translate.md

---
description: 将代码注释翻译为中文
---

请将以下代码中的所有英文注释翻译为中文，保持代码不变：

$ARGUMENTS</code></pre>

        <h3>复杂命令示例</h3>
        <pre><code># .opencode/commands/refactor.md

---
description: 重构代码以提高可维护性
---

请重构以下代码：

## 重构目标
- 提高代码可读性
- 减少重复代码
- 改善命名
- 优化结构

## 约束条件
- 保持公共API不变
- 不改变功能行为
- 添加必要的注释

$ARGUMENTS</code></pre>

        <h2>JSON配置方式</h2>
        <p>JSON方式提供更多配置选项，适合需要复杂设置的命令。</p>

        <h3>在配置文件中定义</h3>
        <pre><code>{
  "command": {
    "test": {
      "template": "为 $1 编写单元测试，使用 $2 测试框架",
      "description": "生成单元测试"
    },
    "doc": {
      "template": "为以下代码生成详细的文档注释：\n\n$ARGUMENTS",
      "description": "生成文档注释"
    }
  }
}</code></pre>

        <h3>完整配置选项</h3>
        <pre><code>{
  "command": {
    "analyze": {
      "template": "分析 $1 的代码复杂度和质量",
      "description": "代码分析",
      "hidden": false
    }
  }
}</code></pre>

        <h2>模板变量</h2>
        <p>自定义命令支持多种模板变量：</p>

        <table>
          <thead><tr><th>变量</th><th>说明</th><th>示例</th></tr></thead>
          <tbody>
            <tr><td><code>$ARGUMENTS</code></td><td>所有输入参数</td><td><code>/cmd hello world</code> → <code>hello world</code></td></tr>
            <tr><td><code>$1</code></td><td>第一个参数</td><td><code>/cmd a b c</code> → <code>a</code></td></tr>
            <tr><td><code>$2</code></td><td>第二个参数</td><td><code>/cmd a b c</code> → <code>b</code></td></tr>
            <tr><td><code>$3</code> ... <code>$9</code></td><td>第3-9个参数</td><td>同上</td></tr>
            <tr><td><code>$FILE</code></td><td>当前文件路径</td><td><code>/path/to/current.ts</code></td></tr>
            <tr><td><code>$SELECTION</code></td><td>当前选中的文本</td><td>IDE中选中的代码</td></tr>
            <tr><td><code>$CLIPBOARD</code></td><td>剪贴板内容</td><td>复制的内容</td></tr>
          </tbody>
        </table>

        <h3>变量使用示例</h3>
        <pre><code># 使用位置参数
# .opencode/commands/convert.md
将 $1 格式转换为 $2 格式：

$3</code></pre>
        <p>使用：<code>/convert JSON YAML @config.json</code></p>

        <pre><code># 使用多个变量
# .opencode/commands/compare.md
比较以下两个实现的优缺点：

## 实现A
$1

## 实现B
$2

请从性能、可读性、可维护性角度分析。</code></pre>

        <h2>命令选项</h2>

        <h3>description - 命令描述</h3>
        <p>在命令列表中显示的描述文本：</p>
        <pre><code>{
  "command": {
    "fix": {
      "template": "修复以下代码中的问题：\n$ARGUMENTS",
      "description": "修复代码问题"
    }
  }
}</code></pre>

        <h3>hidden - 隐藏命令</h3>
        <p>命令不会在自动补全列表中显示，但仍可使用：</p>
        <pre><code>{
  "command": {
    "internal": {
      "template": "内部调试命令：$ARGUMENTS",
      "description": "内部使用",
      "hidden": true
    }
  }
}</code></pre>

        <h2>实用示例</h2>

        <h3>代码审查命令</h3>
        <pre><code># .opencode/commands/cr.md

---
description: 全面的代码审查
---

请对以下代码进行全面审查：

## 审查清单
- [ ] 代码逻辑正确性
- [ ] 错误处理完整性
- [ ] 边界条件处理
- [ ] 代码风格一致性
- [ ] 性能考量
- [ ] 安全性检查
- [ ] 测试覆盖建议

## 代码
$ARGUMENTS

请按照审查清单逐项给出评价和改进建议。</code></pre>

        <h3>Git提交消息生成</h3>
        <pre><code># .opencode/commands/commit.md

---
description: 生成Git提交消息
---

基于以下代码变更，生成符合Conventional Commits规范的提交消息：

变更内容：
$ARGUMENTS

要求：
1. 使用正确的类型前缀（feat/fix/docs/style/refactor/test/chore）
2. 简洁描述变更内容
3. 必要时添加详细说明</code></pre>

        <h3>API文档生成</h3>
        <pre><code># .opencode/commands/apidoc.md

---
description: 生成API文档
---

为以下API生成文档：

$ARGUMENTS

文档格式要求：
- 使用Markdown格式
- 包含端点描述
- 请求参数说明（包括类型、是否必需）
- 响应格式示例
- 错误码说明
- 使用示例</code></pre>

        <h3>测试用例生成</h3>
        <pre><code>{
  "command": {
    "test-unit": {
      "template": "为以下函数生成单元测试：\n\n$ARGUMENTS\n\n要求：\n- 使用 $1 测试框架\n- 覆盖正常情况和边界情况\n- 包含错误处理测试",
      "description": "生成单元测试"
    },
    "test-e2e": {
      "template": "为以下功能生成端到端测试：\n\n$ARGUMENTS\n\n要求：\n- 使用 Playwright/Cypress\n- 覆盖用户主要流程\n- 包含断言验证",
      "description": "生成E2E测试"
    }
  }
}</code></pre>

        <h3>代码解释</h3>
        <pre><code># .opencode/commands/explain.md

---
description: 详细解释代码
---

请详细解释以下代码：

$ARGUMENTS

解释要求：
1. 整体功能概述
2. 逐行/逐块详细解释
3. 使用的设计模式或算法
4. 潜在的注意事项
5. 适合初学者理解的语言</code></pre>

        <h3>性能优化建议</h3>
        <pre><code># .opencode/commands/perf.md

---
description: 性能优化建议
---

分析以下代码的性能，提供优化建议：

$ARGUMENTS

分析维度：
1. 时间复杂度
2. 空间复杂度
3. 内存使用
4. I/O操作
5. 并发处理

请提供具体的优化代码示例。</code></pre>

        <h2>命令组织建议</h2>

        <div class="tip-box info">
          <div class="tip-box-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>组织技巧</div>
          <div class="tip-box-content">
            <ul>
              <li>使用简短、有意义的命令名</li>
              <li>按功能分类命令（review、test、doc等）</li>
              <li>项目特定命令放在项目目录，通用命令放在用户目录</li>
              <li>为每个命令添加description，方便查找</li>
            </ul>
          </div>
        </div>

        <h2>查看已有命令</h2>
        <p>输入<code>/</code>后按Tab键可以查看所有可用命令，包括内置命令和自定义命令。</p>

        <h2>下一步</h2>
        <p>接下来学习MCP协议服务器，了解如何通过MCP扩展OpenCode的能力。</p>
      </div>
      <nav class="article-nav">
        <a href="6.2-formatters.html" class="article-nav-item prev"><div class="article-nav-label">← 上一篇</div><div class="article-nav-title">6.2 代码格式化器</div></a>
        <a href="6.4-mcp.html" class="article-nav-item next"><div class="article-nav-label">下一篇 →</div><div class="article-nav-title">6.4 MCP协议服务器</div></a>
      </nav>
    </article>
  </main>
  <nav class="toc"><div class="toc-title">本页目录</div><ul class="toc-list"></ul></nav>
  <button class="back-to-top" aria-label="回到顶部"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="18 15 12 9 6 15"></polyline></svg></button>
  <script src="../js/main.js"></script>
</body>
</html>
