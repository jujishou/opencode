<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="OpenCode Agents代理系统详解，Build、Plan等专业代理配置。">
  <meta name="keywords" content="OpenCode Agents, AI代理, Build代理, Plan代理">
  <meta name="robots" content="index, follow">
  <title>5.1 Agents代理系统 - OpenCode深度教程</title>
  <link rel="stylesheet" href="../css/style.css">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://opencode.aialiang.com/tutorial/5.1-agents.html">

  <!-- Open Graph Meta Tags -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://opencode.aialiang.com/tutorial/5.1-agents.html">
  <meta property="og:title" content="Agents代理系统 - OpenCode深度教程">
  <meta property="og:description" content="OpenCode Agents代理系统详解，Build、Plan等专业代理配置。">
  <meta property="og:image" content="https://opencode.aialiang.com/images/og-image.png">
  <meta property="og:site_name" content="OpenCode深度教程">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:section" content="第五章：高级配置">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Agents代理系统 - OpenCode深度教程">
  <meta name="twitter:description" content="OpenCode Agents代理系统详解，Build、Plan等专业代理配置。">
  <meta name="twitter:image" content="https://opencode.aialiang.com/images/og-image.png">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Agents代理系统",
    "description": "OpenCode Agents代理系统详解，Build、Plan等专业代理配置。",
    "url": "https://opencode.aialiang.com/tutorial/5.1-agents.html",
    "inLanguage": "zh-CN",
    "isPartOf": {
      "@type": "WebSite",
      "name": "OpenCode深度教程",
      "url": "https://opencode.aialiang.com/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "OpenCode深度教程",
      "url": "https://opencode.aialiang.com/"
    },
    "articleSection": "第五章：高级配置"
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "首页", "item": "https://opencode.aialiang.com/"},
      {"@type": "ListItem", "position": 2, "name": "第五章：高级配置", "item": "https://opencode.aialiang.com/tutorial/5.1.1-agents.html"},
      {"@type": "ListItem", "position": 3, "name": "Agents代理系统", "item": "https://opencode.aialiang.com/tutorial/5.1-agents.html"}
    ]
  }
  </script>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
</head>
<body>
  <nav class="navbar">
    <button class="mobile-menu-btn" aria-label="菜单"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
    <a href="../index.html" class="navbar-brand"><div class="logo">OC</div><span>OpenCode深度教程</span></a>
    <div class="navbar-nav"><a href="../index.html">首页</a><a href="1.1-what-is-opencode.html">教程</a><a href="../community.html">社群</a><a href="https://opencode.ai/docs" target="_blank">官方文档</a><a href="https://github.com/anomalyco/opencode" target="_blank">GitHub</a></div>
    <div class="navbar-right">
      <div class="search-box"><svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" class="search-input" placeholder="搜索教程..."><div class="search-results"></div></div>
      <button class="theme-toggle" aria-label="切换主题"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button>
    </div>
  </nav>

  <aside class="sidebar"><div class="sidebar-content"><div class="sidebar-section"><div class="sidebar-title">第一章：入门指南</div><ul class="sidebar-nav"><li><a href="1.1-what-is-opencode.html"><span class="chapter-number">1.1</span>什么是OpenCode</a></li><li><a href="1.2-installation.html"><span class="chapter-number">1.2</span>安装OpenCode</a></li><li><a href="1.3-quickstart.html"><span class="chapter-number">1.3</span>快速开始</a></li><li><a href="1.4-terminal-requirements.html"><span class="chapter-number">1.4</span>终端要求</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第二章：基础配置</div><ul class="sidebar-nav"><li><a href="2.1-config-file.html"><span class="chapter-number">2.1</span>配置文件详解</a></li><li><a href="2.2-providers.html"><span class="chapter-number">2.2</span>AI提供商配置</a></li><li><a href="2.3-models.html"><span class="chapter-number">2.3</span>模型选择与配置</a></li><li><a href="2.4-environment.html"><span class="chapter-number">2.4</span>环境变量设置</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第三章：界面操作</div><ul class="sidebar-nav"><li><a href="3.1-tui.html"><span class="chapter-number">3.1</span>TUI终端界面</a></li><li><a href="3.2-cli.html"><span class="chapter-number">3.2</span>CLI命令行接口</a></li><li><a href="3.3-web.html"><span class="chapter-number">3.3</span>Web界面</a></li><li><a href="3.4-ide.html"><span class="chapter-number">3.4</span>IDE集成</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第四章：核心功能</div><ul class="sidebar-nav"><li><a href="4.1-tools.html"><span class="chapter-number">4.1</span>内置工具详解</a></li><li><a href="4.2-commands.html"><span class="chapter-number">4.2</span>斜杠命令</a></li><li><a href="4.3-keybinds.html"><span class="chapter-number">4.3</span>快捷键参考</a></li><li><a href="4.4-file-reference.html"><span class="chapter-number">4.4</span>文件引用与搜索</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第五章：高级配置</div><ul class="sidebar-nav"><li><a href="5.1-agents.html" class="active"><span class="chapter-number">5.1</span>Agents代理系统</a></li><li><a href="5.2-rules.html"><span class="chapter-number">5.2</span>Rules规则配置</a></li><li><a href="5.3-themes.html"><span class="chapter-number">5.3</span>主题配置</a></li><li><a href="5.4-permissions.html"><span class="chapter-number">5.4</span>权限系统</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第六章：扩展功能</div><ul class="sidebar-nav"><li><a href="6.1-lsp.html"><span class="chapter-number">6.1</span>LSP语言服务器</a></li><li><a href="6.2-formatters.html"><span class="chapter-number">6.2</span>代码格式化器</a></li><li><a href="6.3-custom-commands.html"><span class="chapter-number">6.3</span>自定义命令</a></li><li><a href="6.4-mcp.html"><span class="chapter-number">6.4</span>MCP协议服务器</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第七章：开发与集成</div><ul class="sidebar-nav"><li><a href="7.1-sdk.html"><span class="chapter-number">7.1</span>SDK使用指南</a></li><li><a href="7.2-network.html"><span class="chapter-number">7.2</span>网络配置</a></li><li><a href="7.3-enterprise.html"><span class="chapter-number">7.3</span>企业版功能</a></li><li><a href="7.4-troubleshooting.html"><span class="chapter-number">7.4</span>故障排除</a></li></ul></div></div></aside>

  <main class="main-content">
    <nav class="breadcrumb">
      <a href="../index.html">首页</a>
      <span class="breadcrumb-separator">/</span>
      <a href="5.1-agents.html">第五章</a>
      <span class="breadcrumb-separator">/</span>
      <span>Agents代理系统</span>
    </nav>

    <article>
      <header class="article-header">
        <h1 class="article-title">5.1 Agents代理系统</h1>
        <div class="article-meta">
          <span class="tag">高级配置</span>
          <span>第五章：高级配置</span>
        </div>
      </header>

      <div class="article-content">
        <p>Agents（代理）是OpenCode的核心概念，它们是具有特定角色和能力的AI助手。通过配置不同的代理，可以针对不同任务优化AI的行为。</p>

        <h2>什么是Agents</h2>
        <p>OpenCode采用多代理架构，包含两类代理：</p>

        <h3>主代理（Primary Agents）</h3>
        <ul>
          <li><strong>Build</strong> - 默认的主代理，用于代码构建、编辑和执行任务</li>
          <li><strong>Plan</strong> - 规划代理，用于任务规划和架构设计，不直接修改代码</li>
        </ul>

        <h3>子代理（Sub Agents）</h3>
        <ul>
          <li><strong>General</strong> - 通用代理，适合一般性任务</li>
          <li><strong>Explore</strong> - 探索代理，专注于代码库探索和理解</li>
        </ul>

        <div class="tip-box info">
          <div class="tip-box-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>代理调用方式</div>
          <div class="tip-box-content">主代理可以通过 <code>/agent &lt;name&gt;</code> 命令切换，子代理由主代理根据任务需要自动调用。</div>
        </div>

        <h2>内置代理介绍</h2>

        <h3>Build代理</h3>
        <p>默认的主代理，具有完整的工具访问权限：</p>
        <ul>
          <li>可以读取、编辑、创建文件</li>
          <li>可以执行shell命令</li>
          <li>可以搜索代码库</li>
          <li>适合实际的开发任务</li>
        </ul>

        <h3>Plan代理</h3>
        <p>规划代理，只有只读权限：</p>
        <ul>
          <li>只能读取文件和搜索代码</li>
          <li>不能修改文件或执行命令</li>
          <li>适合架构设计和任务规划</li>
          <li>输出详细的实施计划</li>
        </ul>

        <h3>Explore代理</h3>
        <p>代码探索专用：</p>
        <ul>
          <li>专注于理解代码结构</li>
          <li>分析依赖关系</li>
          <li>提供代码解释</li>
        </ul>

        <h2>代理配置方法</h2>
        <p>代理可以通过两种方式配置：JSON配置文件或Markdown文件。</p>

        <h3>JSON配置</h3>
        <p>在 <code>opencode.json</code> 中配置：</p>
        <pre><code>{
  "agent": {
    "myagent": {
      "description": "我的自定义代理",
      "mode": "primary",
      "temperature": 0.7,
      "maxSteps": 100,
      "tools": ["read", "edit", "bash"],
      "permission": {
        "bash": "ask"
      },
      "prompt": "你是一个专注于代码审查的AI助手...",
      "model": "claude-sonnet-4-20250514"
    }
  }
}</code></pre>

        <h3>Markdown配置</h3>
        <p>创建 <code>AGENT.md</code> 文件：</p>
        <pre><code>---
description: 代码审查专家
mode: primary
temperature: 0.5
maxSteps: 50
tools:
  - read
  - grep
  - glob
permission:
  bash: deny
model: claude-sonnet-4-20250514
---

# 代码审查代理

你是一个专业的代码审查专家。

## 职责

- 检查代码质量
- 发现潜在问题
- 提供改进建议

## 注意事项

- 关注可读性和可维护性
- 检查安全漏洞
- 验证最佳实践</code></pre>

        <h2>配置选项详解</h2>

        <table>
          <thead><tr><th>选项</th><th>类型</th><th>说明</th></tr></thead>
          <tbody>
            <tr><td><code>description</code></td><td>string</td><td>代理的简短描述，在代理列表中显示</td></tr>
            <tr><td><code>mode</code></td><td>string</td><td>代理模式：<code>primary</code>（主代理）或 <code>sub</code>（子代理）</td></tr>
            <tr><td><code>temperature</code></td><td>number</td><td>生成温度，0-2之间，越高越有创造性</td></tr>
            <tr><td><code>maxSteps</code></td><td>number</td><td>最大执行步骤数，防止无限循环</td></tr>
            <tr><td><code>tools</code></td><td>array</td><td>可用工具列表，如 <code>["read", "edit", "bash"]</code></td></tr>
            <tr><td><code>permission</code></td><td>object</td><td>工具权限配置，覆盖全局设置</td></tr>
            <tr><td><code>prompt</code></td><td>string</td><td>系统提示词，定义代理行为</td></tr>
            <tr><td><code>model</code></td><td>string</td><td>使用的模型，覆盖默认模型</td></tr>
          </tbody>
        </table>

        <h2>创建自定义代理</h2>

        <h3>示例1：安全审计代理</h3>
        <pre><code>{
  "agent": {
    "security": {
      "description": "安全漏洞检测",
      "mode": "primary",
      "temperature": 0.3,
      "maxSteps": 200,
      "tools": ["read", "grep", "glob", "list"],
      "permission": {
        "bash": "deny",
        "edit": "deny",
        "write": "deny"
      },
      "prompt": "你是安全审计专家，专注于发现代码中的安全漏洞..."
    }
  }
}</code></pre>

        <h3>示例2：文档生成代理</h3>
        <pre><code>{
  "agent": {
    "docs": {
      "description": "文档生成助手",
      "mode": "primary",
      "temperature": 0.7,
      "maxSteps": 100,
      "tools": ["read", "write", "glob"],
      "permission": {
        "bash": "deny"
      },
      "prompt": "你是技术文档专家，帮助生成清晰的API文档和README..."
    }
  }
}</code></pre>

        <h3>示例3：测试生成代理</h3>
        <pre><code>{
  "agent": {
    "test": {
      "description": "测试用例生成",
      "mode": "primary",
      "temperature": 0.5,
      "maxSteps": 150,
      "tools": ["read", "write", "edit", "bash", "grep"],
      "permission": {
        "bash": "ask"
      },
      "prompt": "你是测试工程师，专注于生成全面的单元测试和集成测试..."
    }
  }
}</code></pre>

        <h2>切换代理</h2>
        <p>使用斜杠命令切换主代理：</p>
        <pre><code># 切换到Plan代理
/agent plan

# 切换到自定义代理
/agent security

# 切换回Build代理
/agent build</code></pre>

        <div class="tip-box warning">
          <div class="tip-box-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>注意</div>
          <div class="tip-box-content">切换代理会保持当前会话，但代理的行为和权限会改变。确保在切换前保存重要上下文。</div>
        </div>

        <h2>代理继承</h2>
        <p>自定义代理可以基于内置代理进行扩展，只需覆盖需要修改的选项：</p>
        <pre><code>{
  "agent": {
    "careful-build": {
      "description": "谨慎的构建代理",
      "mode": "primary",
      "permission": {
        "bash": "ask",
        "edit": "ask",
        "write": "ask"
      }
    }
  }
}</code></pre>

        <h2>下一步</h2>
        <p>了解如何通过Rules配置文件来定义项目规则和AI行为指南。</p>
      </div>

      <nav class="article-nav">
        <a href="4.4-file-reference.html" class="article-nav-item prev">
          <div class="article-nav-label">← 上一篇</div>
          <div class="article-nav-title">4.4 文件引用与搜索</div>
        </a>
        <a href="5.2-rules.html" class="article-nav-item next">
          <div class="article-nav-label">下一篇 →</div>
          <div class="article-nav-title">5.2 Rules规则配置</div>
        </a>
      </nav>
    </article>
  </main>

  <nav class="toc"><div class="toc-title">本页目录</div><ul class="toc-list"></ul></nav>
  <button class="back-to-top" aria-label="回到顶部"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="18 15 12 9 6 15"></polyline></svg></button>
  <script src="../js/main.js"></script>
</body>
</html>
