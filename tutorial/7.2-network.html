<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="OpenCode网络配置指南，代理设置和网络优化。">
  <meta name="keywords" content="OpenCode网络, 代理配置, 网络设置">
  <meta name="robots" content="index, follow">
  <title>7.2 网络配置 - OpenCode深度教程</title>
  <link rel="stylesheet" href="../css/style.css">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://opencode.aialiang.com/tutorial/7.2-network.html">

  <!-- Open Graph Meta Tags -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://opencode.aialiang.com/tutorial/7.2-network.html">
  <meta property="og:title" content="网络配置 - OpenCode深度教程">
  <meta property="og:description" content="OpenCode网络配置指南，代理设置和网络优化。">
  <meta property="og:image" content="https://opencode.aialiang.com/images/og-image.png">
  <meta property="og:site_name" content="OpenCode深度教程">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:section" content="第七章：开发与集成">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="网络配置 - OpenCode深度教程">
  <meta name="twitter:description" content="OpenCode网络配置指南，代理设置和网络优化。">
  <meta name="twitter:image" content="https://opencode.aialiang.com/images/og-image.png">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "网络配置",
    "description": "OpenCode网络配置指南，代理设置和网络优化。",
    "url": "https://opencode.aialiang.com/tutorial/7.2-network.html",
    "inLanguage": "zh-CN",
    "isPartOf": {
      "@type": "WebSite",
      "name": "OpenCode深度教程",
      "url": "https://opencode.aialiang.com/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "OpenCode深度教程",
      "url": "https://opencode.aialiang.com/"
    },
    "articleSection": "第七章：开发与集成"
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "首页", "item": "https://opencode.aialiang.com/"},
      {"@type": "ListItem", "position": 2, "name": "第七章：开发与集成", "item": "https://opencode.aialiang.com/tutorial/7.2.1-sdk.html"},
      {"@type": "ListItem", "position": 3, "name": "网络配置", "item": "https://opencode.aialiang.com/tutorial/7.2-network.html"}
    ]
  }
  </script>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
</head>
<body>
  <nav class="navbar"><button class="mobile-menu-btn" aria-label="菜单"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button><a href="../index.html" class="navbar-brand"><div class="logo">OC</div><span>OpenCode深度教程</span></a><div class="navbar-nav"><a href="../index.html">首页</a><a href="1.1-what-is-opencode.html">教程</a><a href="../community.html">社群</a><a href="https://opencode.ai/docs" target="_blank">官方文档</a><a href="https://github.com/anomalyco/opencode" target="_blank">GitHub</a></div><div class="navbar-right"><div class="search-box"><svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" class="search-input" placeholder="搜索教程..."><div class="search-results"></div></div><button class="theme-toggle" aria-label="切换主题"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div></nav>
  <aside class="sidebar"><div class="sidebar-content"><div class="sidebar-section"><div class="sidebar-title">第一章：入门指南</div><ul class="sidebar-nav"><li><a href="1.1-what-is-opencode.html"><span class="chapter-number">1.1</span>什么是OpenCode</a></li><li><a href="1.2-installation.html"><span class="chapter-number">1.2</span>安装OpenCode</a></li><li><a href="1.3-quickstart.html"><span class="chapter-number">1.3</span>快速开始</a></li><li><a href="1.4-terminal-requirements.html"><span class="chapter-number">1.4</span>终端要求</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第二章：基础配置</div><ul class="sidebar-nav"><li><a href="2.1-config-file.html"><span class="chapter-number">2.1</span>配置文件详解</a></li><li><a href="2.2-providers.html"><span class="chapter-number">2.2</span>AI提供商配置</a></li><li><a href="2.3-models.html"><span class="chapter-number">2.3</span>模型选择与配置</a></li><li><a href="2.4-environment.html"><span class="chapter-number">2.4</span>环境变量设置</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第三章：界面操作</div><ul class="sidebar-nav"><li><a href="3.1-tui.html"><span class="chapter-number">3.1</span>TUI终端界面</a></li><li><a href="3.2-cli.html"><span class="chapter-number">3.2</span>CLI命令行接口</a></li><li><a href="3.3-web.html"><span class="chapter-number">3.3</span>Web界面</a></li><li><a href="3.4-ide.html"><span class="chapter-number">3.4</span>IDE集成</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第四章：核心功能</div><ul class="sidebar-nav"><li><a href="4.1-tools.html"><span class="chapter-number">4.1</span>内置工具详解</a></li><li><a href="4.2-commands.html"><span class="chapter-number">4.2</span>斜杠命令</a></li><li><a href="4.3-keybinds.html"><span class="chapter-number">4.3</span>快捷键参考</a></li><li><a href="4.4-file-reference.html"><span class="chapter-number">4.4</span>文件引用与搜索</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第五章：高级配置</div><ul class="sidebar-nav"><li><a href="5.1-agents.html"><span class="chapter-number">5.1</span>Agents代理系统</a></li><li><a href="5.2-rules.html"><span class="chapter-number">5.2</span>Rules规则配置</a></li><li><a href="5.3-themes.html"><span class="chapter-number">5.3</span>主题配置</a></li><li><a href="5.4-permissions.html"><span class="chapter-number">5.4</span>权限系统</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第六章：扩展功能</div><ul class="sidebar-nav"><li><a href="6.1-lsp.html"><span class="chapter-number">6.1</span>LSP语言服务器</a></li><li><a href="6.2-formatters.html"><span class="chapter-number">6.2</span>代码格式化器</a></li><li><a href="6.3-custom-commands.html"><span class="chapter-number">6.3</span>自定义命令</a></li><li><a href="6.4-mcp.html"><span class="chapter-number">6.4</span>MCP协议服务器</a></li></ul></div><div class="sidebar-section"><div class="sidebar-title">第七章：开发与集成</div><ul class="sidebar-nav"><li><a href="7.1-sdk.html"><span class="chapter-number">7.1</span>SDK使用指南</a></li><li><a href="7.2-network.html" class="active"><span class="chapter-number">7.2</span>网络配置</a></li><li><a href="7.3-enterprise.html"><span class="chapter-number">7.3</span>企业版功能</a></li><li><a href="7.4-troubleshooting.html"><span class="chapter-number">7.4</span>故障排除</a></li></ul></div></div></aside>
  <main class="main-content">
    <nav class="breadcrumb"><a href="../index.html">首页</a><span class="breadcrumb-separator">/</span><a href="7.1-sdk.html">第七章</a><span class="breadcrumb-separator">/</span><span>网络配置</span></nav>
    <article>
      <header class="article-header"><h1 class="article-title">7.2 网络配置</h1><div class="article-meta"><span class="tag">开发与集成</span><span>第七章：开发与集成</span></div></header>
      <div class="article-content">
        <p>OpenCode支持多种网络配置选项，包括代理设置、自定义认证和CA证书配置，适用于企业环境和特殊网络需求。</p>

        <h2>代理设置</h2>
        <p>OpenCode使用标准的环境变量来配置HTTP/HTTPS代理，与大多数命令行工具兼容。</p>

        <h3>HTTPS_PROXY</h3>
        <p>用于HTTPS请求的代理服务器：</p>
        <pre><code># 设置HTTPS代理
export HTTPS_PROXY=http://proxy.company.com:8080

# 带认证的代理
export HTTPS_PROXY=http://username:password@proxy.company.com:8080

# 使用SOCKS5代理
export HTTPS_PROXY=socks5://proxy.company.com:1080</code></pre>

        <h3>HTTP_PROXY</h3>
        <p>用于HTTP请求的代理服务器：</p>
        <pre><code># 设置HTTP代理
export HTTP_PROXY=http://proxy.company.com:8080

# 带认证的代理
export HTTP_PROXY=http://username:password@proxy.company.com:8080</code></pre>

        <h3>NO_PROXY</h3>
        <p>指定不使用代理的主机或域名：</p>
        <pre><code># 排除本地和内部域名
export NO_PROXY=localhost,127.0.0.1,.company.internal

# 排除特定IP段
export NO_PROXY=localhost,127.0.0.1,10.0.0.0/8,192.168.0.0/16

# 多个域名用逗号分隔
export NO_PROXY=localhost,.local,.internal,api.openai.com</code></pre>

        <div class="tip-box warning">
          <div class="tip-box-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>注意</div>
          <div class="tip-box-content">代理密码中如果包含特殊字符（如 <code>@</code>、<code>:</code>），需要进行URL编码。例如 <code>p@ss:word</code> 应编码为 <code>p%40ss%3Aword</code>。</div>
        </div>

        <h2>认证方法</h2>
        <p>OpenCode支持多种认证方法连接AI提供商。</p>

        <h3>API密钥认证</h3>
        <p>最常用的认证方式，通过环境变量设置：</p>
        <pre><code># Anthropic
export ANTHROPIC_API_KEY=sk-ant-xxx

# OpenAI
export OPENAI_API_KEY=sk-xxx

# Google
export GOOGLE_API_KEY=xxx

# Azure OpenAI
export AZURE_OPENAI_API_KEY=xxx
export AZURE_OPENAI_ENDPOINT=https://xxx.openai.azure.com</code></pre>

        <h3>OAuth认证</h3>
        <p>某些提供商支持OAuth认证流程：</p>
        <pre><code># 使用OAuth登录（会打开浏览器）
opencode auth login anthropic

# 检查认证状态
opencode auth status

# 登出
opencode auth logout anthropic</code></pre>

        <h3>Bearer Token</h3>
        <p>对于自定义端点，可以使用Bearer Token：</p>
        <pre><code>{
  "provider": {
    "custom": {
      "name": "internal-api",
      "baseURL": "https://api.internal.com/v1",
      "headers": {
        "Authorization": "Bearer your-token-here"
      }
    }
  }
}</code></pre>

        <h2>自定义CA证书</h2>
        <p>在企业环境中，可能需要使用自定义CA证书来处理SSL/TLS连接。</p>

        <h3>使用环境变量</h3>
        <pre><code># 指定CA证书文件
export NODE_EXTRA_CA_CERTS=/path/to/ca-bundle.crt

# 或使用SSL_CERT_FILE
export SSL_CERT_FILE=/path/to/ca-bundle.crt

# 指定证书目录
export SSL_CERT_DIR=/path/to/certificates/</code></pre>

        <h3>配置文件方式</h3>
        <pre><code>{
  "network": {
    "ca": "/path/to/ca-bundle.crt",
    "rejectUnauthorized": true
  }
}</code></pre>

        <h3>跳过证书验证（不推荐）</h3>
        <pre><code># 仅用于测试环境
export NODE_TLS_REJECT_UNAUTHORIZED=0</code></pre>

        <div class="tip-box danger">
          <div class="tip-box-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>警告</div>
          <div class="tip-box-content">禁用证书验证会使连接容易受到中间人攻击，仅应在受控的测试环境中使用。</div>
        </div>

        <h2>端口和主机名配置</h2>
        <p>配置OpenCode服务器的监听端口和主机名。</p>

        <h3>服务器模式配置</h3>
        <pre><code># 启动服务器（默认端口）
opencode serve

# 指定端口
opencode serve --port 8080

# 指定主机和端口
opencode serve --host 0.0.0.0 --port 8080</code></pre>

        <h3>配置文件方式</h3>
        <pre><code>{
  "server": {
    "host": "127.0.0.1",
    "port": 8080,
    "cors": {
      "enabled": true,
      "origins": ["http://localhost:3000"]
    }
  }
}</code></pre>

        <h3>Web界面配置</h3>
        <pre><code>{
  "web": {
    "enabled": true,
    "port": 3000,
    "host": "localhost",
    "open": true
  }
}</code></pre>

        <h2>连接超时设置</h2>
        <p>配置API请求的超时时间：</p>
        <pre><code>{
  "network": {
    "timeout": 60000,
    "retries": 3,
    "retryDelay": 1000
  }
}</code></pre>

        <h2>DNS配置</h2>
        <p>对于特殊的DNS需求：</p>
        <pre><code># 使用自定义DNS服务器
export DNS_SERVER=8.8.8.8

# 或在配置文件中
{
  "network": {
    "dns": ["8.8.8.8", "8.8.4.4"]
  }
}</code></pre>

        <h2>调试网络问题</h2>
        <p>启用详细的网络日志以排查问题：</p>
        <pre><code># 启用调试日志
export DEBUG=opencode:network

# 查看HTTP请求详情
export DEBUG=opencode:http

# 启用所有调试日志
export DEBUG=opencode:*</code></pre>

        <div class="tip-box info">
          <div class="tip-box-title"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>提示</div>
          <div class="tip-box-content">如果在企业防火墙后使用OpenCode，建议联系IT部门获取正确的代理配置和CA证书。</div>
        </div>

        <h2>完整配置示例</h2>
        <p>企业环境的完整网络配置：</p>
        <pre><code># ~/.bashrc 或 ~/.zshrc
export HTTPS_PROXY=http://proxy.company.com:8080
export HTTP_PROXY=http://proxy.company.com:8080
export NO_PROXY=localhost,127.0.0.1,.company.internal
export NODE_EXTRA_CA_CERTS=/etc/ssl/certs/company-ca.crt

# API密钥
export ANTHROPIC_API_KEY=sk-ant-xxx</code></pre>

        <pre><code>// opencode.json
{
  "network": {
    "timeout": 120000,
    "retries": 5,
    "retryDelay": 2000
  },
  "server": {
    "host": "127.0.0.1",
    "port": 8080
  }
}</code></pre>

        <h2>下一步</h2>
        <p>接下来了解OpenCode企业版的专属功能和部署选项。</p>
      </div>
      <nav class="article-nav">
        <a href="7.1-sdk.html" class="article-nav-item prev"><div class="article-nav-label">← 上一篇</div><div class="article-nav-title">7.1 SDK使用指南</div></a>
        <a href="7.3-enterprise.html" class="article-nav-item next"><div class="article-nav-label">下一篇 →</div><div class="article-nav-title">7.3 企业版功能</div></a>
      </nav>
    </article>
  </main>
  <nav class="toc"><div class="toc-title">本页目录</div><ul class="toc-list"></ul></nav>
  <button class="back-to-top" aria-label="回到顶部"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="18 15 12 9 6 15"></polyline></svg></button>
  <script src="../js/main.js"></script>
</body>
</html>
